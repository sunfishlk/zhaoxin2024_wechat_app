"use strict";const e=require("../common/vendor.js"),a=require("../utils/log.js"),t={__name:"TimeCard",props:{dateProps:String,timeProps:String},emits:["exit","hide"],setup(t,{emit:l}){const i=t,o=getApp().globalData.baseUrl,s=e.ref([]),u=e.ref(""),n=e.ref(1),r=e.ref(1),c=e=>{e=e.split(" ~ ")[0],m(e)&&(u.value=e,l("exit",e))};let d=e.ref([]),v=e.ref([]),p=e.index.getStorageSync("cookie");e.onMounted((()=>{i.timeProps&&c((e=>{const[a,t]=e.split(":").map(Number),l=t+20,i=l>=60?a+1:a,o=l%60;return`${a.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")} ~ ${i.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`})(i.timeProps)),g(i.dateProps)})),e.watch((()=>i.dateProps),(e=>{e&&(d.value=[],v.value=[],s.value=[],g(e))}));const g=t=>{e.index.request({url:`${o}/api/student/dateitv?date=2024-${t}T00:00:00`,method:"GET",header:{"Content-Type":"application/json",Cookie:p},success:e=>{a.log.info({responseData:e}),!1===e.data.success?console.log(e.data.message):(null===e.data.data.available?console.log(`${t}无可用时间`):e.data.data.available.forEach((e=>{const a=e.substring(11,16);d.value.push(a),s.value.push({time:a,isAvailable:!0})})),null!==e.data.data.unavailable&&e.data.data.unavailable.forEach((e=>{const a=e.substring(11,16);v.value.push(a),s.value.push({time:a,isAvailable:!1})})),r.value=Math.ceil(s.value.length/6),n.value=1)},fail:a=>{console.log(a),e.index.showToast({title:JSON.stringify(a),icon:"none"})}})},m=e=>d.value.includes(e),b=()=>{n.value<r.value&&n.value++},f=()=>{n.value>1&&n.value--},h=e.computed((()=>{const e=6*(n.value-1),a=e+6;return s.value.slice(e,a)}));return(a,t)=>({a:e.o((e=>a.$emit("hide"))),b:e.f(e.unref(h),((a,t,l)=>{return{a:e.t(a.time),b:t,c:(i=a.time,u.value===i?"#eecfd3":"white"),d:a.isAvailable?"black":"#c7d2d4",e:e.o((e=>c(a.time)),t)};var i})),c:e.t("<"),d:e.n({"un-clickable":1===n.value}),e:e.o(f),f:e.t(n.value),g:e.t(r.value),h:e.t(">"),i:e.n({"un-clickable":n.value===r.value}),j:e.o(b)})}},l=e._export_sfc(t,[["__scopeId","data-v-ea2044b1"]]);wx.createComponent(l);
