"use strict";const e=require("../../common/vendor.js"),o=require("../../utils/log.js");Math||t();const t=()=>"../../component/CancelConfirmCard.js",a={__name:"color-egg",setup(t){const a=getApp().globalData.baseUrl,n=o=>{e.index.navigateTo({url:`/pages/${o}/${o}`})},s=()=>{e.index.navigateTo({url:"/pages/basic-info/basic-info"})},i=async()=>{let t="";try{t=await new Promise(((o,t)=>{e.index.login({provider:"weixin",success:e=>{e.code?(console.log("登录 code:",e.code),o(e.code)):(console.log("登录失败！"+e.errMsg),t(new Error("登录失败！"+e.errMsg)))},fail:e=>{console.log(e),t(e)}})})),console.log(t)}catch(n){console.log(n)}t?e.index.request({url:`${a}/api/student`,method:"POST",data:{code:t},success:async a=>{if(o.log.info({requestData:{code:t},responseData:a}),console.log(a),console.log(t),e.index.setStorageSync("cookie",a.cookies[0]),!1===a.data.success)return console.log(a.data.message),void e.index.showToast({title:a.data.message,icon:"none",duration:2e3});if(a.data.data.is_first);else{console.log(a),e.index.setStorageSync("studentNumber",a.data.data.stuinfo.netid),e.index.setStorageSync("name",a.data.data.stuinfo.name),e.index.setStorageSync("phoneNumber",a.data.data.stuinfo.phone),e.index.setStorageSync("email",a.data.data.stuinfo.mail),e.index.setStorageSync("mainDepartment",a.data.data.stuinfo.mainde),e.index.setStorageSync("otherDepartment",a.data.data.stuinfo.secondary),e.index.setStorageSync("skills",a.data.data.stuinfo.already),e.index.setStorageSync("wantToLearn",a.data.data.stuinfo.want),e.index.setStorageSync("whereKnow",a.data.data.stuinfo.whereknow),e.index.setStorageSync("college",a.data.data.stuinfo.clazz);let o=a.data.data.stuinfo.time;if(null===o)e.index.setStorageSync("date",""),e.index.setStorageSync("time","");else{const t=e=>{let[o,t]=e.split("T"),[a,n]=t.split(":"),[s,i,d]=o.split("-");return{date:`${i}-${d}`,time:`${a}:${n}`}};e.index.setStorageSync("date",t(o).date),e.index.setStorageSync("time",t(o).time),console.log(o),console.log(t(o).date),console.log(t(o).time)}}},fail:o=>{console.log(o),e.index.showToast({title:JSON.stringify(o),icon:"none"})}}):console.log("登录 code 不存在")};let d=e.index.getStorageSync("cookie");const c=e.ref(!0),l=()=>{e.index.request({url:`${a}/api/student/itv`,method:"DELETE",header:{"Content-Type":"application/json",Cookie:d},success:t=>{o.log.info({responseData:t}),console.log(t),!1===t.data.success?e.index.showToast({title:t.data.message,icon:"none"}):(i(),e.index.reLaunch({url:"/pages/home/home"}))},fail:o=>{console.log(o),e.index.showToast({title:JSON.stringify(o),icon:"none"})}}),S()},r=()=>{e.index.showToast({title:"已保留报名",icon:"none"}),S()},g=e.ref(!1),u=()=>{g.value=!0},S=()=>{g.value=!1};return e.onMounted((()=>{e.index.request({url:`${a}/api/version?version=1`,method:"GET",success:t=>{o.log.info({responseData:t}),!1===t.data.success?e.index.showToast({title:t.data.message,icon:"none"}):!0===t.data.data.check_interv?c.value=!1:c.value=!0},fail:o=>{console.log(o),e.index.showToast({title:JSON.stringify(o),icon:"none"})}})})),(o,t)=>e.e({a:g.value},g.value?{b:e.o(l),c:e.o(r)}:{},{d:e.o(s),e:e.o((e=>n("QRCode"))),f:e.o((e=>n("position"))),g:e.n(c.value?"hide":""),h:e.o((e=>n("interview-result"))),i:e.n(c.value?"":"hide"),j:e.o(u)})}},n=e._export_sfc(a,[["__scopeId","data-v-d12a68d3"]]);wx.createPage(n);
